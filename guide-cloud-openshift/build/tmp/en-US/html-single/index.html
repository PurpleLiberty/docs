<?xml version='1.0' encoding='UTF-8'?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" class="chrometwo"><head><title>Deploying microservices to OpenShift</title><link rel="stylesheet" type="text/css" href="Common_Content/css/default.css"/><meta name="generator" content="publican v4.3.4"/><meta name="description" content="These topics provide a brief introduction to Open Liberty and links to in-depth documentation resources."/><link rel="next" href="#idm140269437905072" title="Preface"/><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><script type="text/javascript" src="Common_Content/scripts/jquery-1.7.1.min.js"> </script><script type="text/javascript" src="Common_Content/scripts/utils.js"> </script><script type="text/javascript" src="Common_Content/scripts/highlight.js/highlight.pack.js"> </script></head><body><div id="chrometwo"><div id="main"><div xml:lang="en-US" class="book" id="idm140269444038960"><div class="titlepage"><div><div class="producttitle"><span class="productname">Open Liberty</span> <span class="productnumber">19.0.0.9</span></div><div><h1 class="title">Deploying microservices to OpenShift</h1></div><div><h2 class="subtitle">Open Liberty documentation resources for Red Hat Runtimes</h2></div><div><a href="#idm140269437811152">Legal Notice</a></div><div><div class="abstract"><p class="title"><strong>Abstract</strong></p><div class="para">
				These topics provide a brief introduction to Open Liberty and links to in-depth documentation resources.
			</div></div></div></div><hr/></div><div class="toc"><ul class="toc"><li><span class="preface"><a href="#idm140269437905072">Preface</a></span></li><li><span class="chapter"><a href="#what_you_ll_learn">1. What you’ll learn</a></span></li><li><span class="chapter"><a href="#additional_prerequisites">2. Additional prerequisites</a></span></li><li><span class="chapter"><a href="#accessing_an_openshift_cluster">3. Accessing an OpenShift cluster</a></span></li><li><span class="chapter"><a href="#deploying_microservices_to_openshift">4. Deploying microservices to OpenShift</a></span><ul><li><span class="section"><a href="#building_and_containerizing_the_microservices">4.1. Building and containerizing the microservices</a></span></li><li><span class="section"><a href="#pushing_the_images_to_openshift_s_internal_registry">4.2. Pushing the images to OpenShift’s internal registry</a></span></li><li><span class="section"><a href="#deploying_the_microservices">4.3. Deploying the microservices</a></span></li></ul></li><li><span class="chapter"><a href="#making_requests_to_the_microservices">5. Making requests to the microservices</a></span></li><li><span class="chapter"><a href="#testing_the_microservices">6. Testing the microservices</a></span></li><li><span class="chapter"><a href="#tearing_down_the_environment">7. Tearing down the environment</a></span></li><li><span class="chapter"><a href="#great_work_you_re_done">8. Great work! You’re done!</a></span></li></ul></div><section class="preface" id="idm140269437905072"><div class="titlepage"><div><div><h1 class="title">Preface</h1></div></div></div><div class="admonition note hidden"><div class="admonition_header">Note</div><div><p>
				This repository contains the guide documentation source. To view the guide in published form, view it on the <a class="link" href="https://openliberty.io/guides/cloud-openshift.html">Open Liberty website</a>.
			</p></div></div><p>
			Explore how to deploy microservices to Red Hat OpenShift.
		</p></section><section class="chapter" id="what_you_ll_learn"><div class="titlepage"><div><div><h1 class="title">Chapter 1. What you’ll learn</h1></div></div></div><p>
			You will learn how to deploy two microservices in Open Liberty containers to an OpenShift cluster.
		</p><p>
			There are different cloud-based solutions for running your Kubernetes workloads. With a cloud-based infrastructure, you can focus on developing your microservices without worrying about low-level infrastructure details for deployment. Using a cloud helps you to easily scale and manage your microservices in a high-availability setup.
		</p><p>
			Kubernetes is an open source container orchestrator that automates many tasks that are involved in deploying, managing, and scaling containerized applications. If you would like to learn more about Kubernetes, check out the <a class="link" href="https://openliberty.io/guides/kubernetes-intro.html">Deploying microservices to Kubernetes</a> guide.
		</p><p>
			OpenShift is a Kubernetes-based platform with added functions. It streamlines the DevOps process by providing an intuitive development pipeline. It also provides integration with multiple tools to make the deployment and management of cloud applications easier. To learn more about the different platforms that Red Hat OpenShift offers, check out their <a class="link" href="https://docs.openshift.com">official documentation</a>.
		</p><p>
			The two microservices you will deploy are called <code class="literal">system</code> and <code class="literal">inventory</code>. The <code class="literal">system</code> microservice returns the JVM system properties of the running container. It also returns the pod’s name in the HTTP header, making replicas easy to distinguish from each other. The <code class="literal">inventory</code> microservice adds the properties from the <code class="literal">system</code> microservice to the inventory. This process demonstrates how communication can be established between pods inside a cluster.
		</p></section><section class="chapter" id="additional_prerequisites"><div class="titlepage"><div><div><h1 class="title">Chapter 2. Additional prerequisites</h1></div></div></div><p>
			Before you begin, the following additional tools need to be installed:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<span class="strong strong"><strong>Docker:</strong></span> You need a containerization software for building containers. Kubernetes supports various container types, but you will use Docker in this guide. For installation instructions, refer to the official <a class="link" href="https://docs.docker.com/install/">Docker documentation</a>.
				</li><li class="listitem">
					<span class="strong strong"><strong>OpenShift account:</strong></span> To access a Kubernetes cluster, you must sign up for a Red Hat OpenShift online account. To sign up, refer to the <a class="link" href="https://manage.openshift.com/register/plan">official website</a>. Keep in mind that the creation time depends on resource availability and may take some time.
				</li><li class="listitem">
					<span class="strong strong"><strong>OpenShift CLI:</strong></span> You need the OpenShift command-line tool <code class="literal">oc</code> to interact with your Kubernetes cluster. For installation instructions, refer to the official <a class="link" href="https://docs.openshift.com/online/getting_started/beyond_the_basics.html#btb-installing-the-openshift-cli">OpenShift Online documentation</a>.
				</li></ul></div><p>
			To verify that the OpenShift CLI is installed correctly, run the following command:
		</p><pre class="screen command command">oc version</pre><p>
			The output will be similar to:
		</p><pre class="screen no_copy no_copy">Client Version: version.Info{Major:"4", Minor:"1+", GitVersion:"v4.1.14", ... }</pre><p class="command command">
			<a class="link" href="https://raw.githubusercontent.com/OpenLiberty/guides-common/master/gitclone.adoc">https://raw.githubusercontent.com/OpenLiberty/guides-common/master/gitclone.adoc</a>
		</p></section><section class="chapter" id="accessing_an_openshift_cluster"><div class="titlepage"><div><div><h1 class="title">Chapter 3. Accessing an OpenShift cluster</h1></div></div></div><p>
			Before you can deploy your microservices, you must gain access to a cluster on OpenShift.
		</p><p>
			Creating an OpenShift account automatically grants you access to their multi-tenant, OpenShift cluster. After you have access, you are also given access to their online web console. To login to OpenShift by using the CLI, navigate to the online web console by following the <code class="literal">[username] &gt; Copy Login Command &gt; Display Token &gt; Log in with this token</code> path.
		</p><p>
			The command looks like the following example:
		</p><pre class="screen no_copy no_copy">oc login --token=[your-token] --server=https://api.[region].online-starter.openshift.com:[port]</pre><p>
			Create a project by running the following command:
		</p><pre class="screen command command">oc new-project [project-name]</pre></section><section class="chapter" id="deploying_microservices_to_openshift"><div class="titlepage"><div><div><h1 class="title">Chapter 4. Deploying microservices to OpenShift</h1></div></div></div><p>
			In this section, you will learn how to deploy two microservices in Open Liberty containers to a Kubernetes cluster on OpenShift. You will build and containerize the <code class="literal">system</code> and <code class="literal">inventory</code> microservices, push them to a container registry, and then deploy them to your Kubernetes cluster.
		</p><section class="section" id="building_and_containerizing_the_microservices"><div class="titlepage"><div><div><h2 class="title">4.1. Building and containerizing the microservices</h2></div></div></div><p>
				The first step of deploying to Kubernetes is to build your microservices and containerize them.
			</p><p>
				The starting Java project, which is located in the start directory, is a multi-module Maven project. It is made up of the <code class="literal">system</code> and <code class="literal">inventory</code> microservices. Each microservice resides in its own directory, <code class="literal">start/system</code> or <code class="literal">start/inventory</code>. Both of these directories contain a Dockerfile, which is necessary for building the Docker images. See the <a class="link" href="https://openliberty.io/guides/containerize.html">Containerizing microservices</a> guide if you’re unfamiliar with Dockerfiles.
			</p><p>
				If you’re familiar with Maven and Docker, you might be tempted to run a Maven build first and then use the <code class="literal">.war</code> file to build a Docker image. The projects are set up so that this process is automated as a part of a single Maven build.
			</p><p>
				To build these microservices, navigate to the <code class="literal">start</code> directory and run the following command:
			</p><pre class="screen command command">mvn package</pre><p>
				Next, run the <code class="literal">docker build</code> commands to build container images for your application:
			</p><pre class="screen command command">docker build -t system:1.0-SNAPSHOT system/.
docker build -t inventory:1.0-SNAPSHOT inventory/.</pre><p>
				The <code class="literal">-t</code> flag in the <code class="literal">docker build</code> command allows the Docker image to be labeled (tagged) in the <code class="literal">name[:tag]</code> format. The tag for an image describes the specific image version. If the optional <code class="literal">[:tag]</code> tag is not specified, the <code class="literal">latest</code> tag is created by default.
			</p><p>
				During the build, you see various Docker messages that describe what images are being downloaded and built. When the build finishes, run the following command to list all local Docker images:
			</p><pre class="screen command command">docker images</pre><p>
				Verify that the <code class="literal">system:1.0-SNAPSHOT</code> and <code class="literal">inventory:1.0-SNAPSHOT</code> images are listed among them, for example:
			</p><pre class="screen no_copy no_copy">REPOSITORY                    TAG
system                        1.0-SNAPSHOT
inventory                     1.0-SNAPSHOT
open-liberty                  latest</pre><p>
				If you don’t see the <code class="literal">system:1.0-SNAPSHOT</code> and <code class="literal">inventory:1.0-SNAPSHOT</code> images, check the Maven build log for any potential errors.
			</p></section><section class="section" id="pushing_the_images_to_openshift_s_internal_registry"><div class="titlepage"><div><div><h2 class="title">4.2. Pushing the images to OpenShift’s internal registry</h2></div></div></div><p>
				In order to run the microservices on the cluster, you need to push the microservice images into a container image registry. You will use OpenShift’s integrated container image registry called OpenShift Container Registry (OCR). After your images are pushed into the registry, you can use them in the pods you create later in the guide.
			</p><p>
				First, you must authenticate your Docker client to your OCR. Start by running the login command:
			</p><pre class="screen command command">oc registry login</pre><p>
				You can store your Docker credentials in a custom external credential store, which is more secure than using a Docker configuration file. If you are using a custom credential store for securing your registry credentials, or if you are unsure where your credentials are stored, use the following command:
			</p><p>
				<a class="link" href="https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc">https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc</a>
			</p><pre class="screen command command">docker login -u `oc whoami` -p `oc whoami -t` `oc registry info`</pre><p>
				Because the Windows command prompt doesn’t support the command substitution that is displayed for Mac and Linux, run the following commands:
			</p><pre class="screen command command">oc whoami
oc whoami -t
oc registry info</pre><p>
				Replace the square brackets in the following <code class="literal">docker login</code> command with the results from the previous commands:
			</p><pre class="screen command command">docker login -u [oc whoami] -p [oc whoami -t] [oc registry info]</pre><p>
				The command authenticates your credentials against the internal registry so that you are able to push and pull images. The registry address will be displayed after you run the <code class="literal">oc registry login</code> command. It is formatted similar to the following output:
			</p><pre class="screen no_copy no_copy">default-route-openshift-image-registry.apps.[region].starter.openshift-online.com</pre><p>
				You can also view the registry address by running the following command:
			</p><pre class="screen command command">oc registry info</pre><p>
				Ensure that you are logged in to OpenShift and the registry, and run the following commands to tag your applications:
			</p><p>
				<a class="link" href="https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc">https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc</a>
			</p><pre class="screen command command">docker tag system:1.0-SNAPSHOT `oc registry info`/`oc project -q`/system:1.0-SNAPSHOT
docker tag inventory:1.0-SNAPSHOT `oc registry info`/`oc project -q`/inventory:1.0-SNAPSHOT</pre><p>
				Because the Windows command prompt doesn’t support the command substitution that is displayed for Mac and Linux, run the following commands:
			</p><pre class="screen command command">oc registry info
oc project -q</pre><p>
				Replace the square brackets in the following <code class="literal">docker tag</code> commands with the results from the previous commands:
			</p><pre class="screen command command">docker tag system:1.0-SNAPSHOT [oc registry info]/[oc project -q]/system:1.0-SNAPSHOT
docker tag inventory:1.0-SNAPSHOT [oc registry info]/[oc project -q]/inventory:1.0-SNAPSHOT</pre><p>
				Finally, push your images to the registry:
			</p><p>
				<a class="link" href="https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc">https://raw.githubusercontent.com/OpenLiberty/guides-common/master/os-tabs.adoc</a>
			</p><pre class="screen command command">docker push `oc registry info`/`oc project -q`/system:1.0-SNAPSHOT
docker push `oc registry info`/`oc project -q`/inventory:1.0-SNAPSHOT</pre><p>
				Because the Windows command prompt doesn’t support the command substitution that is displayed for Mac and Linux, run the following commands:
			</p><pre class="screen command command">oc registry info
oc project -q</pre><p>
				Replace the square brackets in the following <code class="literal">docker push</code> commands with the results from the previous commands:
			</p><pre class="screen command command">docker push [oc registry info]/[oc project -q]/system:1.0-SNAPSHOT
docker push [oc registry info]/[oc project -q]/inventory:1.0-SNAPSHOT</pre><p>
				After you push the images, run the following command to list the images that you pushed to the internal OCR:
			</p><pre class="screen command command">oc get imagestream</pre><p>
				Verify that the <code class="literal">system</code> and <code class="literal">inventory</code> images are listed among them, for example:
			</p><pre class="screen no_copy no_copy">NAME        IMAGE REPOSITORY                                                                                     TAGS           UPDATED
inventory   default-route-openshift-image-registry.apps.us-west-1.starter.openshift-online.com/guide/inventory   1.0-SNAPSHOT   3 seconds ago
system      default-route-openshift-image-registry.apps.us-west-1.starter.openshift-online.com/guide/system      1.0-SNAPSHOT   17 seconds ago</pre></section><section class="section" id="deploying_the_microservices"><div class="titlepage"><div><div><h2 class="title">4.3. Deploying the microservices</h2></div></div></div><p>
				Now that your container images are built, deploy them by using a Kubernetes object configuration file.
			</p><p>
				Kubernetes objects can be configured in a YAML file that contains a description of all your deployments, services, or any other objects that you want to deploy. All objects can also be deleted from the cluster by using the same YAML file that you used to deploy them. The <code class="literal hotspot">kubernetes.yaml</code> object configuration file is provided for you. If you are interested in learning more about using and configuring Kubernetes clusters, check out the <a class="link" href="https://openliberty.io/guides/kubernetes-intro.html">Deploying microservices to Kubernetes</a> guide.
			</p><p>
				kubernetes.yaml
			</p><pre class="programlisting language-yaml code_column numbered">apiVersion: apps/v1
kind: Deployment
metadata:
  name: system-deployment
  labels:
    app: system
spec:
  selector:
    matchLabels:
      app: system
  template:
    metadata:
      labels:
        app: system
    spec:
      containers:
      - name: system-container
        # tag::systemImage[]
        image: image-registry.openshift-image-registry.svc:5000/[project-name]/system:1.0-SNAPSHOT
        # end::systemImage[]
        ports:
        - containerPort: 9080
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: inventory-deployment
  labels:
    app: inventory
spec:
  selector:
    matchLabels:
      app: inventory
  template:
    metadata:
      labels:
        app: inventory
    spec:
      containers:
      - name: inventory-container
        # tag::inventoryImage[]
        image: image-registry.openshift-image-registry.svc:5000/[project-name]/inventory:1.0-SNAPSHOT
        # end::inventoryImage[]
        ports:
        - containerPort: 9080
---
apiVersion: v1
kind: Service
metadata:
  name: system-service
spec:
  selector:
    app: system
  ports:
  - protocol: TCP
    port: 9080
---
apiVersion: v1
kind: Service
metadata:
  name: inventory-service
spec:
  selector:
    app: inventory
  ports:
  - protocol: TCP
    port: 9080
---
# tag::systemRoute[]
apiVersion: v1
kind: Route
metadata:
  name: system-route
spec:
  to:
    kind: Service
    name: system-service
# end::systemRoute[]
---
# tag::inventoryRoute[]
apiVersion: v1
kind: Route
metadata:
  name: inventory-route
spec:
  to:
    kind: Service
    name: inventory-service
# end::inventoryRoute[]</pre><pre class="screen code_command hotspot code_command hotspot"><span class="marked marked">Update the <code class="literal">kubernetes.yaml</code> file.</span>
<code class="literal">kubernetes.yaml</code></pre><p class="edit_command_text edit_command_text">
				The <code class="literal hotspot=systemImage hotspot=inventoryImage">image</code> is the name and tag of the container image that you want to use for the container. The image address is the OCR address that you logged in to. Update the system <code class="literal hotspot=systemImage">image</code> and the inventory <code class="literal hotspot=inventoryImage">image</code> fields to include your project name.
			</p><p>
				Run the following commands to deploy the objects as defined in kubernetes.yaml file:
			</p><pre class="screen command command">oc apply -f kubernetes.yaml</pre><p>
				You see an output similar to the following example:
			</p><pre class="screen no_copy no_copy">deployment.apps/system-deployment created
deployment.apps/inventory-deployment created
service/system-service created
service/inventory-service created
route.route.openshift.io/system-route created
route.route.openshift.io/inventory-route created</pre><p>
				When the apps are deployed, run the following command to check the status of your pods:
			</p><pre class="screen command command">oc get pods</pre><p>
				If all the pods are healthy and running, you see an output similar to the following example:
			</p><pre class="screen no_copy no_copy">NAME                                    READY     STATUS    RESTARTS   AGE
system-deployment-6bd97d9bf6-4ccds      1/1       Running   0          15s
inventory-deployment-645767664f-nbtd9   1/1       Running   0          15s</pre></section></section><section class="chapter" id="making_requests_to_the_microservices"><div class="titlepage"><div><div><h1 class="title">Chapter 5. Making requests to the microservices</h1></div></div></div><p>
			To access the services and the application, use a route. A route in OpenShift exposes a service at a hostname such as <code class="literal">www.your-web-app.com</code> so external users can access the application.
		</p><p>
			kubernetes.yaml
		</p><pre class="programlisting language-yaml code_column numbered">apiVersion: apps/v1
kind: Deployment
metadata:
  name: system-deployment
  labels:
    app: system
spec:
  selector:
    matchLabels:
      app: system
  template:
    metadata:
      labels:
        app: system
    spec:
      containers:
      - name: system-container
        # tag::systemImage[]
        image: image-registry.openshift-image-registry.svc:5000/[project-name]/system:1.0-SNAPSHOT
        # end::systemImage[]
        ports:
        - containerPort: 9080
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: inventory-deployment
  labels:
    app: inventory
spec:
  selector:
    matchLabels:
      app: inventory
  template:
    metadata:
      labels:
        app: inventory
    spec:
      containers:
      - name: inventory-container
        # tag::inventoryImage[]
        image: image-registry.openshift-image-registry.svc:5000/[project-name]/inventory:1.0-SNAPSHOT
        # end::inventoryImage[]
        ports:
        - containerPort: 9080
---
apiVersion: v1
kind: Service
metadata:
  name: system-service
spec:
  selector:
    app: system
  ports:
  - protocol: TCP
    port: 9080
---
apiVersion: v1
kind: Service
metadata:
  name: inventory-service
spec:
  selector:
    app: inventory
  ports:
  - protocol: TCP
    port: 9080
---
# tag::systemRoute[]
apiVersion: v1
kind: Route
metadata:
  name: system-route
spec:
  to:
    kind: Service
    name: system-service
# end::systemRoute[]
---
# tag::inventoryRoute[]
apiVersion: v1
kind: Route
metadata:
  name: inventory-route
spec:
  to:
    kind: Service
    name: inventory-service
# end::inventoryRoute[]</pre><p>
			Both the <code class="literal hotspot=systemRoute">system</code> and <code class="literal hotspot=inventoryRoute">inventory</code> routes are configured in the <code class="literal hotspot">kubernetes.yaml</code> file, and running the <code class="literal">oc apply -f kubernetes.yaml</code> command exposed both services.
		</p><p>
			Your microservices can now be accessed through the hostnames that you can find by running the following command:
		</p><pre class="screen command command">oc get routes</pre><p>
			They can also be found in the web console by following the <code class="literal">Networking &gt; Routes &gt; Location</code> path. Hostnames are in the <code class="literal">inventory-route-[project-name].apps.[region].starter.openshift-online.com</code> format. Ensure that you are in your project, not the <code class="literal">default</code> project, which is shown in the upper-left corner of the web console.
		</p><p>
			To access your microservices, point your browser to the following URLs. Substitute the appropriate hostnames for the <code class="literal">system</code> and <code class="literal">inventory</code> services:
		</p><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					<code class="literal">http://[system-hostname]/system/properties/</code>
				</li><li class="listitem">
					<code class="literal">http://[inventory-hostname]/inventory/systems</code>
				</li></ul></div><p>
			In the first URL, you see a result in JSON format with the system properties of the container JVM. The second URL returns an empty list, which is expected because no system properties are stored in the inventory yet.
		</p><p>
			Point your browser to the <code class="literal">http://[inventory-hostname]/inventory/systems/system-service</code> URL. When you to go this URL, the system properties that are taken from the <code class="literal">system-service</code> are automatically stored in the inventory. Go back to <code class="literal">http://[inventory-hostname]/inventory/systems</code> and you see a new entry.
		</p></section><section class="chapter" id="testing_the_microservices"><div class="titlepage"><div><div><h1 class="title">Chapter 6. Testing the microservices</h1></div></div></div><p>
			pom.xml
		</p><pre class="programlisting language-xml code_column numbered">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;project xmlns="http://maven.apache.org/POM/4.0.0"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd"&gt;

    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;

    &lt;parent&gt;
        &lt;groupId&gt;net.wasdev.wlp.maven.parent&lt;/groupId&gt;
        &lt;artifactId&gt;liberty-maven-app-parent&lt;/artifactId&gt;
        &lt;version&gt;RELEASE&lt;/version&gt;
    &lt;/parent&gt;

    &lt;groupId&gt;io.openliberty.guides&lt;/groupId&gt;
    &lt;artifactId&gt;kube-demo&lt;/artifactId&gt;
    &lt;version&gt;1.0-SNAPSHOT&lt;/version&gt;
    &lt;packaging&gt;pom&lt;/packaging&gt;

    &lt;properties&gt;
        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;
        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;
        &lt;maven.compiler.source&gt;1.8&lt;/maven.compiler.source&gt;
        &lt;maven.compiler.target&gt;1.8&lt;/maven.compiler.target&gt;
        &lt;!-- Plugins --&gt;
        &lt;version.maven-war-plugin&gt;2.6&lt;/version.maven-war-plugin&gt;
        &lt;version.exec-maven-plugin&gt;1.6.0&lt;/version.exec-maven-plugin&gt;
        &lt;version.maven-surefire-plugin&gt;3.0.0-M1&lt;/version.maven-surefire-plugin&gt;
        &lt;version.maven-failsafe-plugin&gt;3.0.0-M1&lt;/version.maven-failsafe-plugin&gt;
        &lt;!-- OpenLiberty runtime --&gt;
        &lt;version.openliberty-runtime&gt;RELEASE&lt;/version.openliberty-runtime&gt;
        &lt;http.port&gt;9080&lt;/http.port&gt;
        &lt;https.port&gt;9443&lt;/https.port&gt;
        &lt;!-- Default test properties --&gt;
        &lt;!-- tag::systemIP[] --&gt;
        &lt;system.ip&gt;system-service-[project-name].apps.[cluster-ip].online-starter.openshift.com&lt;/system.ip&gt;
        &lt;!-- end::systemIP[] --&gt;
        &lt;!-- tag::inventoryIP[] --&gt;
        &lt;inventory.ip&gt;inventory-service-[project-name].apps.[cluster-ip].online-starter.openshift.com&lt;/inventory.ip&gt;
        &lt;!-- end::inventoryIP[] --&gt;
        &lt;!-- tag::systemKubeService[] --&gt;
        &lt;system.kube.service&gt;system-service&lt;/system.kube.service&gt;
        &lt;!-- end::systemKubeService[] --&gt;
    &lt;/properties&gt;

    &lt;dependencyManagement&gt;
        &lt;dependencies&gt;
           &lt;dependency&gt;
               &lt;groupId&gt;io.openliberty.features&lt;/groupId&gt;
               &lt;artifactId&gt;features-bom&lt;/artifactId&gt;
               &lt;version&gt;RELEASE&lt;/version&gt;
               &lt;type&gt;pom&lt;/type&gt;
               &lt;scope&gt;import&lt;/scope&gt;
           &lt;/dependency&gt;
           &lt;dependency&gt;
                &lt;groupId&gt;org.eclipse.microprofile.rest.client&lt;/groupId&gt;
                &lt;artifactId&gt;microprofile-rest-client-api&lt;/artifactId&gt;
                &lt;version&gt;1.0.1&lt;/version&gt;
                &lt;scope&gt;provided&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;junit&lt;/groupId&gt;
                &lt;artifactId&gt;junit&lt;/artifactId&gt;
                &lt;version&gt;4.12&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.glassfish&lt;/groupId&gt;
                &lt;artifactId&gt;javax.json&lt;/artifactId&gt;
                &lt;version&gt;1.0.4&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;
                &lt;artifactId&gt;cxf-rt-rs-extension-providers&lt;/artifactId&gt;
                &lt;version&gt;3.2.6&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;
                &lt;artifactId&gt;cxf-rt-rs-client&lt;/artifactId&gt;
                &lt;version&gt;3.2.6&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
                &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;
                &lt;version&gt;3.0&lt;/version&gt;
                &lt;scope&gt;compile&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;!-- Support for JDK 9 and above --&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.xml.bind&lt;/groupId&gt;
                &lt;artifactId&gt;jaxb-api&lt;/artifactId&gt;
                &lt;version&gt;2.3.1&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
                &lt;artifactId&gt;jaxb-core&lt;/artifactId&gt;
                &lt;version&gt;2.3.0.1&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;com.sun.xml.bind&lt;/groupId&gt;
                &lt;artifactId&gt;jaxb-impl&lt;/artifactId&gt;
                &lt;version&gt;2.3.2&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
            &lt;dependency&gt;
                &lt;groupId&gt;javax.activation&lt;/groupId&gt;
                &lt;artifactId&gt;activation&lt;/artifactId&gt;
                &lt;version&gt;1.1.1&lt;/version&gt;
                &lt;scope&gt;test&lt;/scope&gt;
            &lt;/dependency&gt;
        &lt;/dependencies&gt;
    &lt;/dependencyManagement&gt;

    &lt;profiles&gt;
        &lt;profile&gt;
            &lt;id&gt;windowsExtension&lt;/id&gt;
            &lt;activation&gt;
                &lt;os&gt;&lt;family&gt;Windows&lt;/family&gt;&lt;/os&gt;
            &lt;/activation&gt;
            &lt;properties&gt;
                &lt;kubectl.extension&gt;.cmd&lt;/kubectl.extension&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;
        &lt;profile&gt;
            &lt;id&gt;nonWindowsExtension&lt;/id&gt;
            &lt;activation&gt;
                &lt;os&gt;&lt;family&gt;!Windows&lt;/family&gt;&lt;/os&gt;
            &lt;/activation&gt;
            &lt;properties&gt;
                &lt;kubectl.extension&gt;&lt;/kubectl.extension&gt;
            &lt;/properties&gt;
        &lt;/profile&gt;
    &lt;/profiles&gt;

    &lt;build&gt;
        &lt;pluginManagement&gt;
            &lt;plugins&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                    &lt;artifactId&gt;maven-war-plugin&lt;/artifactId&gt;
                    &lt;version&gt;${version.maven-war-plugin}&lt;/version&gt;
                    &lt;configuration&gt;
                        &lt;failOnMissingWebXml&gt;false&lt;/failOnMissingWebXml&gt;
                        &lt;packagingExcludes&gt;pom.xml&lt;/packagingExcludes&gt;
                    &lt;/configuration&gt;
                &lt;/plugin&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;net.wasdev.wlp.maven.plugins&lt;/groupId&gt;
                    &lt;artifactId&gt;liberty-maven-plugin&lt;/artifactId&gt;
                    &lt;configuration&gt;
                        &lt;assemblyArtifact&gt;
                            &lt;groupId&gt;io.openliberty&lt;/groupId&gt;
                            &lt;artifactId&gt;openliberty-runtime&lt;/artifactId&gt;
                            &lt;version&gt;RELEASE&lt;/version&gt;
                            &lt;type&gt;zip&lt;/type&gt;
                        &lt;/assemblyArtifact&gt;
                    &lt;/configuration&gt;
                &lt;/plugin&gt;
                &lt;!-- Plugin to run unit tests --&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                    &lt;artifactId&gt;maven-surefire-plugin&lt;/artifactId&gt;
                    &lt;version&gt;${version.maven-surefire-plugin}&lt;/version&gt;
                    &lt;executions&gt;
                        &lt;execution&gt;
                            &lt;phase&gt;test&lt;/phase&gt;
                            &lt;id&gt;default-test&lt;/id&gt;
                            &lt;configuration&gt;
                                &lt;excludes&gt;
                                    &lt;exclude&gt;**/it/**&lt;/exclude&gt;
                                &lt;/excludes&gt;
                                &lt;reportsDirectory&gt;
                                    ${project.build.directory}/test-reports/unit
                                &lt;/reportsDirectory&gt;
                            &lt;/configuration&gt;
                        &lt;/execution&gt;
                    &lt;/executions&gt;
                &lt;/plugin&gt;
                &lt;!-- Plugin to run functional tests --&gt;
                &lt;plugin&gt;
                    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
                    &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;
                    &lt;version&gt;${version.maven-failsafe-plugin}&lt;/version&gt;
                    &lt;executions&gt;
                        &lt;execution&gt;
                            &lt;phase&gt;integration-test&lt;/phase&gt;
                            &lt;id&gt;integration-test&lt;/id&gt;
                            &lt;goals&gt;
                                &lt;goal&gt;integration-test&lt;/goal&gt;
                            &lt;/goals&gt;
                            &lt;configuration&gt;
                                &lt;includes&gt;
                                    &lt;include&gt;**/it/**&lt;/include&gt;
                                &lt;/includes&gt;
                                &lt;systemPropertyVariables&gt;
                                    &lt;system.kube.service&gt;
                                        ${system.kube.service}
                                    &lt;/system.kube.service&gt;
                                    &lt;system.ip&gt;
                                        ${system.ip}
                                    &lt;/system.ip&gt;
                                    &lt;inventory.ip&gt;
                                        $(inventory.ip)
                                    &lt;/inventory.ip&gt;
                                    &lt;system.ingress.path&gt;
                                        ${system.ingress.path}
                                    &lt;/system.ingress.path&gt;
                                    &lt;inventory.ingress.path&gt;
                                        ${inventory.ingress.path}
                                    &lt;/inventory.ingress.path&gt;
                                &lt;/systemPropertyVariables&gt;
                            &lt;/configuration&gt;
                        &lt;/execution&gt;
                        &lt;execution&gt;
                            &lt;id&gt;verify-results&lt;/id&gt;
                            &lt;goals&gt;
                                &lt;goal&gt;verify&lt;/goal&gt;
                            &lt;/goals&gt;
                        &lt;/execution&gt;
                    &lt;/executions&gt;
                    &lt;configuration&gt;
                        &lt;summaryFile&gt;
                            ${project.build.directory}/test-reports/it/failsafe-summary.xml
                        &lt;/summaryFile&gt;
                        &lt;reportsDirectory&gt;
                            ${project.build.directory}/test-reports/it
                        &lt;/reportsDirectory&gt;
                    &lt;/configuration&gt;
                &lt;/plugin&gt;
            &lt;/plugins&gt;
        &lt;/pluginManagement&gt;
    &lt;/build&gt;

    &lt;modules&gt;
        &lt;module&gt;system&lt;/module&gt;
        &lt;module&gt;inventory&lt;/module&gt;
    &lt;/modules&gt;

&lt;/project&gt;</pre><p>
			A few tests are included for you to test the basic functions of the microservices. If a test failure occurs, then you might have introduced a bug into the code. To run the tests, wait for all pods to be in the ready state before you proceed further. The default properties that are defined in the <code class="literal hotspot">pom.xml</code> file are:
		</p><div class="informaltable"><table class="lt-4-cols lt-7-rows"><colgroup><col style="width: 13%; " class="col_1"/><col style="width: 87%; " class="col_2"/></colgroup><thead><tr><th align="left" valign="top" id="idm140269443160448" scope="col"><span class="strong strong"><strong>Property</strong></span></th><th align="left" valign="top" id="idm140269442570240" scope="col"><span class="strong strong"><strong>Description</strong></span></th></tr></thead><tbody><tr><td align="left" valign="top" headers="idm140269443160448">
						<p>
							<code class="literal hotspot=systemIP">system.ip</code>
						</p>
						</td><td align="left" valign="top" headers="idm140269442570240">
						<p>
							IP or hostname of the <code class="literal">system-service</code> Kubernetes Service
						</p>
						</td></tr><tr><td align="left" valign="top" headers="idm140269443160448">
						<p>
							<code class="literal hotspot=inventoryIP">inventory.ip</code>
						</p>
						</td><td align="left" valign="top" headers="idm140269442570240">
						<p>
							IP or hostname of the <code class="literal">inventory-service</code> Kubernetes Service
						</p>
						</td></tr><tr><td align="left" valign="top" headers="idm140269443160448">
						<p>
							<code class="literal hotspot=systemKubeService">system.kube.service</code>
						</p>
						</td><td align="left" valign="top" headers="idm140269442570240">
						<p>
							Name of the Kubernetes Service wrapping the <code class="literal">system</code> pods, <code class="literal">system-service</code> by default
						</p>
						</td></tr></tbody></table></div><p>
			Use the following command to run the integration tests against your cluster. Substitute <code class="literal">[region]</code> and <code class="literal">[project-name]</code> with the appropriate values:
		</p><pre class="screen command command">mvn verify -Ddockerfile.skip=true \
-Dsystem.ip=system-route-[project-name].apps.[region].starter.openshift-online.com  \
-Dinventory.ip=inventory-route-[project-name].apps.[region].starter.openshift-online.com</pre><div class="itemizedlist"><ul class="itemizedlist" type="disc"><li class="listitem">
					The <code class="literal">dockerfile.skip</code> parameter is set to <code class="literal">true</code> to skip building a new container image.
				</li><li class="listitem">
					The <code class="literal">system.ip</code> parameter is replaced with the appropriate hostname to access your system microservice.
				</li><li class="listitem">
					The <code class="literal">inventory.ip</code> parameter is replaced with the appropriate hostname to access your inventory microservice.
				</li></ul></div><p>
			If the tests pass, you see an output for each service similar to the following example:
		</p><pre class="screen no_copy no_copy">-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.system.SystemEndpointTest
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.673 sec - in it.io.openliberty.guides.system.SystemEndpointTest

Results:

Tests run: 2, Failures: 0, Errors: 0, Skipped: 0</pre><pre class="screen no_copy no_copy">-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running it.io.openliberty.guides.inventory.InventoryEndpointTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.222 sec - in it.io.openliberty.guides.inventory.InventoryEndpointTest

Results:

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0</pre></section><section class="chapter" id="tearing_down_the_environment"><div class="titlepage"><div><div><h1 class="title">Chapter 7. Tearing down the environment</h1></div></div></div><p>
			When you no longer need your deployed microservices, you can delete the Kubernetes deployments, services, and routes by running the following command:
		</p><pre class="screen command command">oc delete -f kubernetes.yaml</pre><p>
			To delete the pushed images, run the following commands:
		</p><pre class="screen command command">oc delete imagestream/inventory
oc delete imagestream/system</pre><p>
			Finally, you can delete the project by running the following command:
		</p><pre class="screen command command">oc delete project [project-name]</pre></section><section class="chapter" id="great_work_you_re_done"><div class="titlepage"><div><div><h1 class="title">Chapter 8. Great work! You’re done!</h1></div></div></div><p>
			You just deployed two microservices running in Open Liberty to OpenShift. You also learned how to use <code class="literal">oc</code> to deploy your microservices on a Kubernetes cluster.
		</p><p>
			<a class="link" href="https://raw.githubusercontent.com/OpenLiberty/guides-common/master/attribution.adoc">https://raw.githubusercontent.com/OpenLiberty/guides-common/master/attribution.adoc</a>
		</p></section><div><div xml:lang="en-US" class="legalnotice" id="idm140269437811152"><h1 class="legalnotice">Legal Notice</h1><div class="para">
		Copyright <span class="trademark"/>© 2019 Red Hat, Inc.
	</div><div class="para">
		The text of and illustrations in this document are licensed by Red Hat under a Creative Commons Attribution–Share Alike 3.0 Unported license ("CC-BY-SA"). An explanation of CC-BY-SA is available at <a class="uri" href="http://creativecommons.org/licenses/by-sa/3.0/">http://creativecommons.org/licenses/by-sa/3.0/</a>. In accordance with CC-BY-SA, if you distribute this document or an adaptation of it, you must provide the URL for the original version.
	</div><div class="para">
		Red Hat, as the licensor of this document, waives the right to enforce, and agrees not to assert, Section 4d of CC-BY-SA to the fullest extent permitted by applicable law.
	</div><div class="para">
		Red Hat, Red Hat Enterprise Linux, the Shadowman logo, the Red Hat logo, JBoss, OpenShift, Fedora, the Infinity logo, and RHCE are trademarks of Red Hat, Inc., registered in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Linux</span>® is the registered trademark of Linus Torvalds in the United States and other countries.
	</div><div class="para">
		<span class="trademark">Java</span>® is a registered trademark of Oracle and/or its affiliates.
	</div><div class="para">
		<span class="trademark">XFS</span>® is a trademark of Silicon Graphics International Corp. or its subsidiaries in the United States and/or other countries.
	</div><div class="para">
		<span class="trademark">MySQL</span>® is a registered trademark of MySQL AB in the United States, the European Union and other countries.
	</div><div class="para">
		<span class="trademark">Node.js</span>® is an official trademark of Joyent. Red Hat is not formally related to or endorsed by the official Joyent Node.js open source or commercial project.
	</div><div class="para">
		The <span class="trademark">OpenStack</span>® Word Mark and OpenStack logo are either registered trademarks/service marks or trademarks/service marks of the OpenStack Foundation, in the United States and other countries and are used with the OpenStack Foundation's permission. We are not affiliated with, endorsed or sponsored by the OpenStack Foundation, or the OpenStack community.
	</div><div class="para">
		All other trademarks are the property of their respective owners.
	</div></div></div></div></div></div><script type="text/javascript">
                        jQuery(document).ready(function() {
                            initSwitchery();
                            jQuery('pre[class*="language-"]').each(function(i, block){hljs.highlightBlock(block);});
                        });
                    </script></body></html>